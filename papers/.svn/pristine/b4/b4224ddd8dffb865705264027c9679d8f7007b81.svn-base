\documentclass[lnicst]{svmultln}

\usepackage{graphicx,url}

\usepackage[english]{babel}
\usepackage[latin1]{inputenc}  

\newcommand{\fig}[4][tb]{
  \begin{figure}[#1]
    {\centering{\includegraphics[#4]{fig/#2}}\par}
    \caption{#3}
    \label{fig:#2}
  \end{figure}
}

\usepackage{multirow}
%\setlength{\tabcolsep}{1mm}
\newcommand{\tab}[4][tb]{
  \begin{table}[tb]
    \caption{#3}\label{tab:#2}
    {\centering\footnotesize\textsf{\input{fig/#2.tab}}\par}
  \end{table}
}


\begin{document} 

\mainmatter

\title{\textsc{SmartBuildings} as Autonomous Distributed Systems}

\author{Arliones Hoeller Jr \and Antônio Augusto Fröhlich}

\authorrunning{Arliones Hoeller Jr. et al.}

\tocauthor{Arliones Hoeller Jr., Antônio Augusto Fröhlich}

\institute{Software/Hardware Integration Lab\\
Federal University of Santa Catarina (UFSC)\\
P.O. Box 476 -- 89.040-900 -- Florianópolis -- SC\\
\email{{arliones,guto}@lisha.ufsc.br}
}

\maketitle


\begin{abstract}
The \textsc{SmartGrid} has come to describe a next-generation electrical power
system that is typified by the increased use of communications and information
technology in the generation, transmission, distribution, and consumption of
electrical energy.
% The utmost objective of integrating all of worlds' energy sources and users into
% the (unique) Earth's \textsc{SmartGrid} brings rise to what may be considered
% the greatest distributed system ever built~\cite{GreenCitiesComputer} by the
% men.
All around the world, utility companies are integrating power plants in order to
balance energy availability and be able to adapt to variations in consumption
demands. As on the start-points of the energy chain, the intelligent end-points
(i.e., \textsc{SmartHomes}, \textsc{SmartBuildings}) may decrease their energy
footprint as they become able to reduce power,
%(i.e., control its windows to take advantage of sunlight),
to use alternative power sources,
%(i.e., solar panels),
or to schedule their energy demands to take the best benefit from energy's
availability and cost.
From a computer science perspective, these buildings have become complex
autonomous distributed systems, once they must adapt themselves to variations on
energy availability and demands.
% In order to do that, these smart end-points became complex distributed systems,
% interconnected by several distinct communication technologies.
In this paper we describe the approach that is being used to raise UFSC's first
\textsc{SmartBuilding}. An overview of such building is given that shows
important design decisions, with a special focus on the automation network's
technology, topology, and control applications. Finally, we present current
status by showing preliminary results. We also enumerate a set of lessons
learned and challenges identified so far.

\keywords {\ldots}
\end{abstract}

% \begin{resumo} 
%   Este meta-artigo descreve o estilo a ser usado na confecção de artigos e
%   resumos de artigos para publicação nos anais das conferências organizadas
%   pela SBC. É solicitada a escrita de resumo e abstract apenas para os artigos
%   escritos em português. Artigos em inglês deverão apresentar apenas abstract.
%   Nos dois casos, o autor deve tomar cuidado para que o resumo (e o abstract)
%   não ultrapassem 10 linhas cada, sendo que ambos devem estar na primeira
%   página do artigo.
% \end{resumo}


\section{Introduction}

% \note{Alternative power sources, environmental sensing}
\textsc{SmartBuildings} are those buildings where automation systems
integrate electronic devices and, by deploying some sort of intelligence, makes
it possible to monitor and manage building's equipments, providing efficient and
reliable operation of building services. Integration of building services is,
however, an intricate task as different systems usually implement different
communication protocols and require distinct security or comfort regulations to
be fulfilled. Usual building services include lighting, HVAC, access control,
and fire detection systems, for which \textsc{BACnet} and \textsc{LonWorks} are
often available. Smarter management of such systems, however, require more
sophisticate sensing mechanisms, such as accurate and distributed temperature,
lighting, and presence sensors. Moreover, newer Green Buildings are increasingly
deploying alternate energy sources such as solar or wind energy systems. Such
systems also integrate other equipment like inverters and battery banks. In
order to integrate these systems to the building's automation network other
application-level protocols than \textsc{BACnet} need to be deployed.

% \note{Knowing where energy is spent (consumption sensors)}
One of the main objectives of an intelligent control system in a
\textsc{SmartBuilding} is to make it energy-efficient. For this, important
information to increase building energy-efficiency is a fine grain profile of
energy consumption. Having energy meters distributed over the building's power
network may allow enhance the efficacy of energy-related decisions. For instance, if
energy consumption of the entire building is detected to be above the desired at
the given time, instead of taking building-wide decisions such as increasing
temperature to decrease air-conditioning system energy consumption, the central
system may detect which sectors of, or which devices in, the building are
consuming more energy than expected and disconnect devices that are not
critical. Measuring energy consumption at a finer grain may also help to build a
greener conscientiousness on building users by allowing to emit per room/user
profiles of energy consumption.

% \note{Intelligence to control}
Building such ``intelligent'' management rules, however, is not a trivial task.
Defining which sections or devices in the network are critical or not still
depend on user interaction. Other renewable energy-related information such as
energy availability from solar panels, which depends on weather and solar
irradiation forecasts are subject to the high error of such prediction methods.
Finally, building user or room specific energy consumption profiles and
estimating the energy to be consumed by devices or building sectors require the
reunion of historical information and the deployment of heuristic of artificial
intelligence methods able to take efficient management decisions.

\section{Building automation}

% \note{BacNet}
Several approaches exist to serve as communication technology and control
standard in automated buildings. \textsc{BACnet} is a data communication
protocol for building automation and control networks. It was first standardized
by ASHRAE/ANSI in 1995~\cite{ASHRAE-BACnet:1995}, and is designed to allow
communication in building's control network for applications such as
HVAC\footnote{Heating, Ventilation, and Air-Conditioning} control, lightning
control, access control, and fire detection systems. It specifies a set of
application-level services and defines a number of compatible standards for the
lower network layers (network, data-link, and physical). These include, for
instance, Ethernet, \textsc{BACnet/IP}, point-to-point RS-232, token-passing
RS-485, and \textsc{LonTalk}.

% \note{LonWorks}
A similar approach is that of \textsc{LonWorks}~\cite{ISO14908:2008}. It defines
a networking platform for control applications. Altought mostly used in building
automation applications under the \textsc{BACnet} standard for HVAC and
lightning applications, its power line and twisted pair communication standards
have also been standardized for use in control systems of trains, petrol
stations, and semiconductor industry manufacturing. It is important to note that
the standard is ratified as the European building automation
standard~\cite{EN14908:2005}, Chinese building and intelligent community
standard~\cite{GBT20299.4:2006}. It has also been indicated as part of the
Application Internetworking Specification (AIS) of the Household Appliances
Control and Monitoring section of the European Committee of Domestic Equipment
Manufacturers~\cite{CECED-AIS:2007}.


% \note{IEEE 802.15.4}
The IEEE 802.15.4 standard specifies the physical layer and the media access
control protocol of the link layer to build a low-rate wireless personal area
network (LR-WPAN) communication protocol. It is the basis for a series of
protocol stack specifications such as ZigBee~\cite{ZigBee},
ISA100.11a~\cite{ISA100.11:2005}, and WirelessHART~\cite{WHart:2007}. The
standard focuses on the development of low-cost and low-power hardware, what
poses performance restrictions on the technology, making it able to operate with
bitrates of up to 250 kbps.


% \note{ITU-T G.HNEM}
Other technologies widely deployed in building automation is composed by those
using narrow-band power line communications (NB-PLC)~\cite{Oksman:2011}, in
which low-power signals are transmited at higher frequencies over power line
cables. The ITU-T defines a standard to ensure interoperability of NB-PLC
solutions called \textsc{G.hnem}. The standard also takes into account
country-specific specifications such as frequency bands and maximum signal
power, being currently compatible with CENELEC/Europe, FCC/USA, and ARIB/Japan
regulations.

\textsc{G.hnem} is, in fact, an umbrella for a set of other more specific
standards, some of which are still under development or awaiting for approval.
The \textsc{G.9955} and \textsc{G.9956} specifies, respectively, the standard's
physical and data link layers. It comprises mechanisms already implemented by
commercially available solutions and a few extensions aiming to build a securer
and interoperable network.

\fig{ghem-net_model}{G.hnem network model. (Figure by Oksman and
Zhang~\cite{Oksman:2011})}{width=\columnwidth}

Figure~\ref{fig:ghem-net_model} shows a hypothetical building automation network
topology using \textsc{G.hnem}. The addressing mechanism used by the standard
allows the devices to be separated into domains. Some nodes may be deployed for
bridging distinct domains, making network-wide communications feasible. Also,
special nodes may be used for bridging \textsc{G.hnem} to alien protocols. Each
domain has a master, which is responsible for performing administrative tasks
such as node admission and resignation, and for keeping the network synchronized
through the emission of beacon packets. Coordination and synchronization among
domain masters is performed by a global master.

Each node implements a network stack comprised of, at least, three layers:
physical, link, and application. The physical layer is OFDM on a QAM modulation
model with tone mapping, which allows for better performance on high
interference environments. Allowed frequency bands (``bandplans'') and signal
power will depend on each region regulations. The link layer is split into MAC
and LLC sublayers. MAC is CSMA/CA with four priority levels, being one reserved
for emergency messages and the other three delivered to the application. The LLC
implements retransmission and acknowledgement mechanisms, security (AES-128),
and a ``L2 routing'' mechanism that may be enabled if the above layers won't
implement routing. The standard recommendation is to use an IPv6 implementation
for the network layer. In this case, the LLC layer also performs packet
fragmentation to be able to deal with the high noise PLC environment.

closing\ldots

\section{UFSC's Green Buildings}

% \note{Overview of the building (Architecture + Energy sources + Automation)}
Since early 2011, an inter-departmental team of the Federal University of Santa
Catarina (UFSC) have been working to raise UFSC's first \textsc{SmartBuildings}.
This team is formed by professors and students from several departments,
including civil, electrical, automation, and mechanics engineering,
architecture, and computer science. The building, besides serving as workplace
for the research team, is intended to serve as a prototype and showroom of new
technologies related to green and renewable energy themes.

\fig{smartbuilding}{3D view of UFSC's
\textsc{SmartBuildings}.}{width=\columnwidth}

Figure~\ref{fig:smartbuilding} shows a 3D view of the buildings. The
architectural project has carefully deployed windows and water mirrors to
increase lightning efficiency and humidification. Both buildings will be covered
by photovoltaic panels. As a research prototype, different types of photovoltaic
panels are being deployed to address specific research needs of the group.
Block~A (on the left) will be assembled with both amorph and crystalline silicon
panels, summing up to 35,643 kWp (killwatts peak) of power. Block B (on the
right) will be partially covered by the same type of crystalline silicon panels
on block A, and partially covered by a flexible type crystalline panel, summing
up to 14,51 kWp. The total power of the building is expected to be of 50,153
kWp, what may allow it to operate autonomously most of the time.


\fig{building_components}{Components at UFSC
\textsc{SmartBuildings}.}{width=\columnwidth}

% \note{Network topology and communication solutions}
UFSC \textsc{SmartBuildings} include a set of smart components (shown in
Figure~\ref{fig:building_components}) that will allow for better energy
consumption management. One of these components is a smart wall socket that
features a NB-PLC communication capabilities and is able to measure energy
consumption. Through communication, the smart socket is able to either block or
release power to the equipment connected to it, or, in specific cases, to be
connected to the equipment's specific communication interface, allowing
integration of, virtually, any equipment to the buildings' PLC network. 

\fig{socket}{Smart Wall Socket.}{width=\columnwidth}

The first steps towards a building prototype had already been taken. The smart
wall sockets (shown in Figure~\ref{fig:socket}) have been implemented as an
extension to the \textsc{EPOSMote} project~\cite{EPOSMote:2012}. It integrated
to the \textsc{EPOSMote} a Motorola ??? PLC modem, an ??? hall-effect energy
consumption meter, and tree different types of power actuation mechanisms to be
used by equipments with different power consumption. An triac-based power
actuation system was designed to act on low-power equipment such as a dimmer for
LED lamps. A relay-based circuit was also designed to act on higher-power
equipment, such as virtually all other equipment in the building. An extra
actuation system was designed to be integrated to other devices featuring some
control communication interface, such as the air-conditioning system used in
the prototype.
Tablets running Android were used to implement the RFID-based access control and
the building's audio and video communication system. An Android-TV was also used
to present the general building report on energy-efficiency.


\fig{scada_data}{SCADA system topology.}{width=\columnwidth}

% \note{Sensed data: light, temperature, presence, and energy availability and
% consumption consumption} 
% \note{Actuation points: LED lamps, AC system, disabling unused resources}

A Supervisory Control And Data Acquisition (SCADA) system was built using the
\textsc{ScadaBr} project~\cite{ScadaBr:2011}. In this system, data is stored in
a database and interfaces are provided so that actions may be performed in the
network and data may be made available to visual interfaces, as shown in
Figure~\ref{fig:scada_data}. The SCADA system uses the concept of ``data
points''. A data point represents a variable either monitored or controlled by
the system. The system read data from network's devices and feed this data into
specific input data points. The SCADA system then processes data either when
they change or periodically, and set new values to output data points. Finally,
the system take these output data points and send them to their respective
devices in order to act on the nertwork.

Decision is made by scripts stored in the SCADA system. Such scripts may be
either simple decision trees or complex IA algorithms. 
Actuation is implemented using two main mechanisms from the SCADA system:
\begin{itemize}
  \item \textbf{Events and event handlers:} Some data points may be configured
  to generate events when their values present some characteristics. When this
  is used, event handlers may be assigned to handle such events.
  \item \textbf{Data points and scripts:} Scripts are triggered upon the
  modification of any input data point. When change occours in the input, the
  scripts are ran and new outputs are generated.
\end{itemize}
For instance, rules such as setting hall lamps to be off from 0 a.m. until 6 a.m
may be implemented using a timed event (current time is the input data point) to
trigger scheduled handlers that either turn the laps off or on. A luminosity
control system may be implemented using a script, that set new levels for the
lamps dimmers (output data points) every time the luminosity readings from the
lightning sensors close to the lamps change their values (input data points).

\tab{data_points}{SCADA system input and output data points.}

\fig{global_rules}{Decision tree with global building management
rules.}{width=\columnwidth}

% \note{Building intelligence: global rules}
Control of the system have been so far implemented in two levels: global level
and room level. Table~\ref{tab:data_points} shows input and output data points
in the system. This first prototype is managing devices in the system with using
scripts implementing decision trees. Figure~\ref{fig:global_rules} shows the
decision tree for the global rules. The global decisions focus, mainly, on the
building energy sources. Depending on the status of external energy source,
battery, and incoming solar energy, the global building status is set to a
priority level ranging from 0 to 5. When at level 0, the system is critically
out of energy and everything is shutdown. At level 5, energy availability is
normal and the building may operate adequately.

\fig{room_rules}{Decision tree with room management rules.}{width=\columnwidth}

% \note{Building intelligence: room rules}
To control energy consumption of rooms independently, a set of rules is also
defined as shown in Figure~\ref{fig:room_rules}. A variable sets the room status
based on global building status and to a priority level set to each room (i.e.,
$room\_staus = global\_status + room\_priority$). The room priority may be
assigned a value between 0 and 5.

% \note{Building intelligence: better rules}
As a first prototype to validate the building automation infrastructure the
results achieved so far may be considered satisfactory. The current rules,
however, cannot ensure autonomous operation of the building yet. Future work on
the supervisory system will focus on efficient management and allocation of energy
from the solar panels. The objective is to be able not only to be independent
from external energy sources, but also be able to sell solar energy back to the
external grid when it become possible.
To achieve this objective, new ways of detecting user behavior patterns and
efficient methods to manage building services need to be deployed. Integration
with other network technologies such as IEEE 802.15.4 also need to be done to
enable the system to control more devices on the building.


% \section{Discussion}
% 
% \note{Lessons learned:  Communication standard, PLC topology, PLC interference.}
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% 
% \note{Challenges: Robustness agains PLC interference, Complex IA for system
% management, Integration with specific devices.}
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá
% blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá blá


\section{Closing}

% \note{So far the project is\ldots\\By (when?) it is expected to be ready.}
This paper have shown current status of a project in the Federal University of
Santa Catarina that is building a smart, green building. The project goal is to
integrate in the building a set of novel technologies including alternative,
renewable energy sources, novel building automation approaches, and new
intelligence systems to build a greener building. These technologies form in the
building a complex distributed system, for which adequate monitoring and control
need to be provided. Moreover, once the buildings have alternative energy
sources in them, they are also expected to operate autonomously, demanding them
for extra intelligence in the system.

More information concerning the automation project of UFSC's green buildings
may be found at the project website:
\begin{verbatim}http://smartbuilding.lisha.ufsc.br\end{verbatim}

\section*{Acknowledgements}
Authors would like to thank other UFSC's teams involved in the project for
making some images and data available, specially Prof. Ricardo Rüther and people
at UFSC's Photovoltaic Group, headed by him. Also, authors would like to thank
Rodrigo Steiner, André Carvalho, Ingrid Cezário, and students from the 2011's
edition of the software/hardware integration course of the computer science
bachelor program that helped to build important parts of the current prototype.
Finally, we thank Komeco S.A. for supporting the integration of their air
conditioning system to our system.

\bibliographystyle{plain}
\bibliography{paper}

\end{document}
