\section{Evaluation and Results}
\label{sec:evaluation_and_results}

{\bf Guto, falta finalizar simulacoes para a versao do EA-ADHOP utilizando o lifetime. Os resultados parciais mostram um desempenho ainda melhor com esta heur√≠stica.}

%(OMNeT++)
The experiments use the OMNeT++ network simulator.
The simulator is an extensible, modular, component-based C++ framework for building network simulations, and it is useful while modeling wireless communication.
The simulation parameters follow the characteristics of a specific wireless sensing module: the \textsc{EPOSMote}~\cite{Eposmote:2012}.
The \textsc{EPOSMote} is a modular platform for building wireless sensor network applications.
It features a RF transceiver compatible with IEEE 802.15.4 standard and an integrated 32-bit ARM7 processor.

\begin{table}[h]
\centering
\caption{Current drain of CPU and Radio in \textsc{EPOSMote}.}
\label{tab:emote-energy_currents}
\begin{tabular}{l|r}
\hline
\hline
\textbf{Device/Mode}  & \textbf{Current Drain} \\
\hline
CPU Active Current    & $3.3~mAh$     \\
CPU Sleep Current     & $60~\mu Ah$   \\
CPU Hibernate Current & $0.9~\mu Ah$  \\
\hline
Radio Tx Current       & $28.3~mAh$   \\
Radio Rx Current       & $21.3~mAh$   \\
Radio Sleep Current    & $0.1~\mu Ah$ \\
\hline
\end{tabular}
\end{table}


%- Experimental setup
Table~\ref{tab:omnet} shows the OMNeT++ simulation parameters used for an IEEE 802.15.4 simulated network.
In these experiments, each simulation scenario ran for 900 seconds in an environment of high mobility that is conducive to high data loss.
The simulation places nodes randomly in a squared area of $1.44~km^2$ (edges of twelve hundred meters), and each node moves at a maximum speed of five meters per second, according to the Mass Mobility algorithm~\cite{Perkins:1999}.
Twenty mobile source nodes generates data traffic to other twenty mobile sink nodes.
The experiment explores the behavior of ADHOP when varying the heuristic information and the number of nodes, ranging from twenty to two hundred.

\begin{table}[h]
\centering
\caption{OMNeT++ Configuration}
\label{tab:omnet}
\begin{tabular}{l|r}
\hline \hline
\multicolumn{2}{l}{\bf{Parameter}}  \\
\hline
Simulation Time               & $900~seconds$     \\
Number of Nodes               & $20 \sim 200$     \\
Area                          & $1200m~X~1200m$   \\
Mobility Model                & $Mass~Mobility$   \\
Application Message Length    & $32~bytes$        \\
Application Message Frequency & $4~seconds$       \\
UDP Header Length             & $8~bytes$         \\
IP Header Length              & $20~bytes$        \\
Netmask                       & $255.255.0.0$     \\
ADHOP Header Length           & $20~bytes$        \\
IEEE 802.15.4 ACK             & $True$            \\
IEEE 802.15.4 Header Length   & $22~bytes$        \\
IEEE 802.15.4 Max Frame Size  & $102~bytes$       \\
PHY Transmitter Power         & $1~mW$            \\
PHY Sensitivity               & $-85~dBm$         \\
PHY Thermal Noise             & $-110~dBm$        \\
Channel Carrier Frequency     & $2.4~GHz$         \\
Battery Voltage               & $3~V$             \\
\hline
\end{tabular}
\end{table}

% Analyzed data
The experiments evaluate the energy-aware version of ADHOP using the two heuristic metrics: battery charge (EA-ADHOP-B) and estimated lifetime (EA-ADHOP-L).
The results show how the EA-ADHOP compares to three other routing algorithms: the original ADHOP, AOER, and AODV.
The battery charge simulation parameter for the evaluation of EA-ADHOP using the battery charge as heuristic metric had to be reduced to match the simulation length.
This happens because if the battery size is too large there would not be enough time in the simulation for it to show a relevant variation on its charge.
This is not the case when EA-ADHOP uses the estimated lifetime as heuristic metric, once the targeted lifetime may dilute the battery size for the short-lengthened simulation.
The parameters related to the energy source used in the simulation are in Table~\ref{tab:omnet_en}.

\begin{table}[h]
\centering
\caption{OMNeT++ configuration of parameters related to the energy source.}
\label{tab:omnet_en}
\begin{tabular}{l|r}
\hline \hline
\multicolumn{2}{c}{\bf{Battery Charge Heuristic Metric}}  \\
\multicolumn{2}{c}{\bf{EA-ADHOP-B}}  \\
\hline
Battery Capacity            & $2~mAh$         \\
\hline
\multicolumn{2}{c}{\bf{Estimated Lifetime Heuristic Metric}}  \\
\multicolumn{2}{c}{\bf{EA-ADHOP-L}}  \\
\hline
Battery Capacity            & $2~mAh$         \\
Targeted Lifetime           & $900~seconds$         \\
\hline
\end{tabular}
\end{table}
 

%- Simulation results
Figure~\ref{consumption} shows that average energy consumption is very similar among the compared approaches.
However, the reduced standard deviations of the energy consumption shown in Figure~\ref{standard_deviation} for the energy-aware versions suggest that there is a better distribution of traffic among nodes.
Also, the graphics show that EA-ADHOP-L performs better than EA-ADHOP-B.
This is because the response time of the battery lifetime metric is faster than that of the battery charge.

\begin{figure}[h]
\centering
\includegraphics[width=\columnwidth]{fig/average_consumption.pdf}
\caption{Average Energy Consumption}
\label{consumption}
\end{figure}

Figure~\ref{standard_deviation} shows the standard deviation of the energy consumption of the nodes after 900 seconds of intense data transmission.
On average, EA-ADHOP improves the balance of energy consumption by approximately $20\%$ compared to ADHOP.
The average standard deviation of AOER and AODV are around $23\%$.

\begin{figure}[h]
\centering
\includegraphics[width=\columnwidth]{fig/standard_deviation.pdf}
\caption{Standard Deviation - Energy Consumption}
\label{standard_deviation}
\end{figure}

The EA-ADHOP approaches produce better results in terms of energy-efficiency.
The energy efficiency, shown in Figure~\ref{relation} in logarithmic scale, is the division of the overall energy consumption by the amount of packets successfully delivered.
The energy consumption per delivered packet of EA-ADHOP-B is, in average, approximately $66\%$ that of ADHOP and, respectively, 17.5\% and 18\% those of AOER and AODV.
We can notice that this approach can improve energy use while reducing the energy consumption and enhancing data delivery ratio.
This differs from AOER, which has an aggressive method to reduce the energy consumption, thus affecting the data delivery ratio, as shown in Figure~\ref{data_packet_delivery_ratio}.
This adds to the low bit rate of IEEE 802.15.4 nodes, making the connectivity worse in higher speeds \cite{Zen:2008}.
This means greater competition for the medium implying in collisions, congestions, data loss, and greater energy consumption for mobile, dense, and scalable networks, causing the depletion of energy on the routes.

\begin{figure}[h]
\centering
\includegraphics[width=\columnwidth]{fig/relation.pdf}
\caption{Energy Consumption per Delivered Data.}
\label{relation}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=\columnwidth]{fig/data_packet_delivery_ratio.pdf}
\caption{Delivery Ratio of Data Packets.}
\label{data_packet_delivery_ratio}
\end{figure}

Another important characteristic of ADHOP is show in Figure~\ref{routing_overhead}.
As less routing failures happen, the protocol overhead is significantly lower.

\begin{figure}[h]
\centering
\includegraphics[width=\columnwidth]{fig/routing_overhead.pdf}
\caption{Overhead for the maintenance of the routing mechanism.}
\label{routing_overhead}
\end{figure}


%- Discussion
The results show that the EA-ADHOP heuristic not only homogenizes the energy consumption on the network but, also, enhances the data delivery ratio and, consequently, makes the system more energy-efficient because it spends less energy per delivered packet.


% section evaluation_and_results (end)

