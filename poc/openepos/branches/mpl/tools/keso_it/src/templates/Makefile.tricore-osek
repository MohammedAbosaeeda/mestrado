HOST		= Linux
BOARD		= TriboardTC1796
TOOL		= gnu

include	$(OSEK_BASE)/boards/$(BOARD)/make.$(TOOL)

FILE		= keso_main
BUILD_DIR	= $(BOARD)$(TOOL)

ifeq ($(USE_SED),1)
OIL_FILE        = $(BUILD_DIR)/keso_main.oil
else
OIL_FILE        = keso_main.oil
endif

OBJS_USER = keso_main.o
LIBS_USER = -lkesosys -lKESO-tricore-osek -lminigcc
LIBDIRS += -L$(KESOSRCPATH)/kore -L$(BUILD_DIR) 

#################################################################
# OBBS_USER will be already defined by the autogenerated Makefile
# which includes this Makefile
OBJS_USER += $(OBJS_DEMO)

#################################################################
# Generic makefiles that declare default variables.

include $(OSEK_BASE)/make/host.$(HOST)
include $(OSEK_BASE)/make/make.$(CPU)$(TOOL)

ifeq ($(DERIVATE),TC1796)
SYSTEM_TIMER = STM_T0
else
SYSTEM_TIMER = GPTU0_T0
endif

ifeq ($(USE_SED),1)
$(BUILD_DIR)/keso_main.oil:	keso_main.oil
	sed -e "s/TC1775B/$(DERIVATE)/" keso_main.oil | sed -e "s/GPTU0_T0/$(SYSTEM_TIMER)/" > $(BUILD_DIR)/keso_main.oil
endif

BUILD_DIR_OBJS_KESO = $(foreach file,$(OBJS_KESO), $(BUILD_DIR)$(DIRCHAR)$(file))

prepdir:
	$(MKDIR) -p $(BUILD_DIR)

kesolib: prepdir $(BUILD_DIR_OBJS_KESO)
	$(AR) rc $(BUILD_DIR)$(DIRCHAR)libkesosys.a  $(BUILD_DIR_OBJS_KESO)


